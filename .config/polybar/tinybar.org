path=/dev/shm/tinybar.$USER.running

type=$(
	if [ -e "$path" ]
	then
		head -n 1 "$path"
	fi
)
sleep 60
if [ "$type" ]
then
	for id in $(pgrep -af polybar | grep $type | awk '{print $1}'); do
		kill $id
	done
fi


if [ "$1" == $type ] || [ "$1" == 'kill' ]
then
	rm $path
#	for id in $(pgrep -af polybar | grep $type | awk '{print $1}'); do
#		kill $id
#	done
else
#	for id in $(pgrep -af polybar | grep $type | awk '{print $1}'); do
#		kill $id
#	done
	for m in $(polybar --list-monitors | cut -d":" -f1); do
		MONITOR=$m polybar -c ~/.config/polybar/tinybar.ini $1 &
	done
	echo $1 > $path
fi


